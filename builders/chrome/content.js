!function(){"use strict";var t,e,r,s={48302:function(t,e,r){r.d(e,{decryptData:function(){return o},encryptData:function(){return a},ko:function(){return n}});var s=r(90749);r(21396),r(17871);function n(t){return s.validateMnemonic(t)}async function a(t,e){try{const r=new Uint8Array(32);crypto.getRandomValues(r);const s=await crypto.subtle.importKey("raw",(new TextEncoder).encode(e),{name:"PBKDF2"},!1,["deriveBits","deriveKey"]),n=await crypto.subtle.deriveBits({name:"PBKDF2",salt:r,iterations:1e5,hash:"SHA-256"},s,256),a=new Uint8Array(16);crypto.getRandomValues(a);const o=await crypto.subtle.importKey("raw",n,{name:"AES-GCM"},!1,["encrypt"]),i=await crypto.subtle.encrypt({name:"AES-GCM",iv:a},o,(new TextEncoder).encode(t)),c=new Uint8Array(r.length+a.length+i.byteLength);return c.set(r,0),c.set(a,r.length),c.set(new Uint8Array(i),r.length+a.length),btoa(String.fromCharCode(...Array.from(c)))}catch(t){throw new Error("Encryption failed: "+t)}}async function o(t,e){try{const r=new Uint8Array(atob(t).split("").map(t=>t.charCodeAt(0))),s=r.slice(0,32),n=r.slice(32,48),a=r.slice(48),o=await crypto.subtle.importKey("raw",(new TextEncoder).encode(e),{name:"PBKDF2"},!1,["deriveBits","deriveKey"]),i=await crypto.subtle.deriveBits({name:"PBKDF2",salt:s,iterations:1e5,hash:"SHA-256"},o,256),c=await crypto.subtle.importKey("raw",i,{name:"AES-GCM"},!1,["decrypt"]),u=await crypto.subtle.decrypt({name:"AES-GCM",iv:n},c,a);return(new TextDecoder).decode(u)}catch(t){return null}}},81078:function(t,e,r){var s=r(17952),n=r(18336);var a=r(8051);const o=new s.T,i=new class{constructor(){this.currentNetwork=null,this.networks=Object.entries(n.Of).map(([t,e])=>({...e,id:t,isCustom:!1,isEnabled:!0})),this.currentNetwork=this.networks[0]||null,this.loadNetworks()}async loadNetworks(){try{const t=await chrome.storage.local.get(["networks","currentNetwork"]);t.networks&&(this.networks=t.networks),t.currentNetwork&&(this.currentNetwork=t.currentNetwork)}catch(t){}}async saveNetworks(){try{await chrome.storage.local.set({networks:this.networks,currentNetwork:this.currentNetwork})}catch(t){}}getDefaultNetworks(){return Object.entries(n.Of).map(([t,e])=>({...e,id:t,isCustom:!1,isEnabled:!0}))}getAllNetworks(){return this.networks}getCurrentNetwork(){return this.currentNetwork}getNetworkById(t){return this.networks.find(e=>e.id===t)}async switchNetwork(t){const e=this.getNetworkById(t);if(!e)throw new Error(`Network ${t} not found`);if(!e.isEnabled)throw new Error(`Network ${e.name} is disabled`);this.currentNetwork=e,await this.saveNetworks()}async addCustomNetwork(t){const e={...t,isCustom:!0};this.networks.push(e),await this.saveNetworks()}async removeCustomNetwork(t){this.networks=this.networks.filter(e=>!(e.id===t&&e.isCustom)),this.currentNetwork?.id===t&&(this.currentNetwork=this.networks[0]||null),await this.saveNetworks()}async toggleNetwork(t){const e=this.getNetworkById(t);e&&(e.isEnabled=!e.isEnabled,await this.saveNetworks())}async updateNetworks(t){this.networks=t,await this.saveNetworks()}async getBalance(t,e){try{return await(0,n.r1)(t,e)}catch(t){return"0x0"}}async getGasPrice(t){try{return await(0,n.getGasPrice)(t)}catch(t){return"0x0"}}async estimateGas(t,e){try{return await(0,n.estimateGas)(t.from||"0x0000000000000000000000000000000000000000",t.to||"0x0000000000000000000000000000000000000000",t.value||"0x0",t.data||"0x",e)}catch(t){return"0x5208"}}async testConnection(t){try{const e=await fetch(t.rpcUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",method:"eth_blockNumber",params:[],id:1})});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return!(await e.json()).error}catch(t){return!1}}getSupportedNetworks(){return this.networks.filter(t=>t.isEnabled).map(t=>t.id)}getNetworkInfo(t){return this.getNetworkById(t)||null}validateNetworkConfig(t){const e=[];return t.id||e.push("Network ID is required"),t.name||e.push("Network name is required"),t.rpcUrl||e.push("RPC URL is required"),t.chainId||e.push("Chain ID is required"),t.symbol||e.push("Symbol is required"),t.rpcUrl&&!t.rpcUrl.startsWith("http")&&e.push("RPC URL must start with http:// or https://"),t.chainId&&!/^0x[0-9a-fA-F]+$/.test(t.chainId)&&e.push("Chain ID must be a valid hex string starting with 0x"),{isValid:0===e.length,errors:e}}},c=new class{constructor(){this.transactions=[],this.pendingTransactions=[],this.pendingTimeouts=new Map,this.walletManager=new s.T,this.loadTransactions(),this.startPendingTransactionMonitoring()}async loadTransactions(){try{chrome.storage.local.get(["transactions"],t=>{t.transactions&&(this.transactions=t.transactions)})}catch(t){}}async saveTransactions(){try{chrome.storage.local.set({transactions:this.transactions})}catch(t){}}async savePendingTransactions(){try{chrome.storage.local.set({pendingTransactions:this.pendingTransactions})}catch(t){}}async getWalletFromStorage(){return new Promise(t=>{chrome.storage.local.get(["wallet"],e=>{t(e.wallet||null)})})}async sendTransaction(t,e,s){try{if(!this.walletManager.getCurrentWallet())throw new Error("No wallet available");const n=this.walletManager.getCurrentAccount();if(!n)throw new Error("No account available");const{ethers:a}=await r.e(96).then(r.bind(r,57908)),{getRealBalance:o,estimateGas:i,getGasPrice:c,getTransactionCount:u,signTransaction:l,sendSignedTransaction:d}=await Promise.resolve().then(r.bind(r,18336)),h=await o(n.address,s),w=a.parseEther(e),g=BigInt(h);if(g<w)throw new Error("Insufficient balance");const f=await c(s),p=await i(n.address,t,w.toString(),"0x",s),y=BigInt(p)*BigInt(f);if(g<w+y)throw new Error("Insufficient balance for gas fees");const m=await u(n.address,s),k={to:t,value:w.toString(),data:"0x",gasLimit:p,gasPrice:f,nonce:m},T=await l(k,n.privateKey,s),v=await d(T,s),b={id:v,hash:v,from:n.address,to:t,value:e,network:s,status:"pending",timestamp:Date.now(),gasPrice:a.formatUnits(f,"gwei"),nonce:parseInt(m,16),gasLimit:p,data:"0x",confirmations:0,fee:(BigInt(p)*BigInt(f)).toString(),type:"send"};return this.pendingTransactions.push(b),this.savePendingTransactions(),v}catch(t){throw t}}async monitorTransaction(t){const e=n.Of[t.network];if(!e)return;new a.FR(e.rpcUrl);const r=async()=>{try{const e=await(0,n.h9)(t.hash,t.network);if(e){t.status="0x1"===e.status?"confirmed":"failed",t.blockNumber=parseInt(e.blockNumber,16),t.confirmations=parseInt(e.confirmations,16),await this.saveTransactions();const r=this.pendingTimeouts.get(t.hash);r&&(clearTimeout(r),this.pendingTimeouts.delete(t.hash))}else{const e=setTimeout(r,1e4);this.pendingTimeouts.set(t.hash,e)}}catch(e){const s=setTimeout(r,3e4);this.pendingTimeouts.set(t.hash,s)}};r()}startPendingTransactionMonitoring(){this.transactions.filter(t=>"pending"===t.status).forEach(t=>{this.monitorTransaction(t)})}getTransaction(t){return this.transactions.find(e=>e.hash===t)}getAllTransactions(){return this.transactions}getTransactionsByNetwork(t){return this.transactions.filter(e=>e.network===t)}getPendingTransactions(){return this.transactions.filter(t=>"pending"===t.status)}getTransactionHistory(t=50){return this.transactions.slice(0,t)}async refreshTransaction(t){const e=this.getTransaction(t);if(!e)return null;try{const r=await(0,n.h9)(t,e.network);if(r)return e.status="0x1"===r.status?"confirmed":"failed",e.blockNumber=parseInt(r.blockNumber,16),e.confirmations=parseInt(r.confirmations,16),await this.saveTransactions(),e}catch(t){}return e}async refreshPendingTransactions(){const t=this.getPendingTransactions();for(const e of t)await this.refreshTransaction(e.hash)}async clearTransactionHistory(){this.transactions=[],await this.saveTransactions()}getTransactionStats(){return{total:this.transactions.length,pending:this.transactions.filter(t=>"pending"===t.status).length,confirmed:this.transactions.filter(t=>"confirmed"===t.status).length,failed:this.transactions.filter(t=>"failed"===t.status).length,totalValue:this.transactions.filter(t=>"send"===t.type).reduce((t,e)=>t+parseFloat(e.value),0).toString(),totalFees:this.transactions.reduce((t,e)=>t+parseFloat(e.fee),0).toString()}}async estimateTransactionFee(t,e,r="0x",s){try{const o=n.Of[s];if(!o)throw new Error(`Unsupported network: ${s}`);const i=new a.FR(o.rpcUrl),c=await this.getWalletFromStorage();if(!c?.address)throw new Error("No wallet found");const u=await(0,n.estimateGas)(c.address,t,e,r,s),l=await i.getFeeData(),d=l.gasPrice?.toString()||"20000000000",h=(BigInt(u)*BigInt(d)).toString();return{gasLimit:u.toString(),gasPrice:d,totalFee:h}}catch(t){throw t}}},u=new class{constructor(){this.positions=[],this.protocols=[],this.loadDeFiData()}async loadDeFiData(){try{const t=await chrome.storage.local.get(["defiPositions","defiProtocols"]);t.defiPositions&&(this.positions=t.defiPositions),t.defiProtocols&&(this.protocols=t.defiProtocols)}catch(t){}}async saveDeFiData(){try{await chrome.storage.local.set({defiPositions:this.positions,defiProtocols:this.protocols})}catch(t){}}async addPosition(t){const e={...t,id:`defi-${Date.now()}-${Math.random().toString(36).substr(2,9)}`};this.positions.push(e),await this.saveDeFiData()}async removePosition(t){this.positions=this.positions.filter(e=>e.id!==t),await this.saveDeFiData()}getAllPositions(){return this.positions}getPositionsByProtocol(t){return this.positions.filter(e=>e.protocol===t)}getPositionsByNetwork(t){return this.positions.filter(e=>e.network===t)}getPositionsByType(t){return this.positions.filter(e=>e.type===t)}getTotalValueLocked(){return this.positions.reduce((t,e)=>t+e.valueUSD,0)}getTotalRewards(){return this.positions.reduce((t,e)=>t+e.rewardsValueUSD,0)}getAverageAPY(){if(0===this.positions.length)return 0;return this.positions.reduce((t,e)=>t+e.apy,0)/this.positions.length}async addProtocol(t){const e={...t,id:`protocol-${Date.now()}-${Math.random().toString(36).substr(2,9)}`};this.protocols.push(e),await this.saveDeFiData()}getAllProtocols(){return this.protocols}getProtocolsByNetwork(t){return this.protocols.filter(e=>e.network===t)}getProtocolsByType(t){return this.protocols.filter(e=>e.type===t)}async updatePosition(t,e){const r=this.positions.find(e=>e.id===t);r&&(Object.assign(r,e),await this.saveDeFiData())}async refreshPositions(){this.positions.forEach(t=>{t.apy+=2*(Math.random()-.5);const e=.1*(Math.random()-.5);t.valueUSD*=1+e,t.timestamp=Date.now()}),await this.saveDeFiData()}getDeFiStatistics(){const t={},e={};return this.positions.forEach(r=>{t[r.protocol]=(t[r.protocol]||0)+r.valueUSD,e[r.network]=(e[r.network]||0)+r.valueUSD}),{totalPositions:this.positions.length,totalValue:this.getTotalValueLocked(),totalRewards:this.getTotalRewards(),averageAPY:this.getAverageAPY(),byProtocol:t,byNetwork:e}}searchPositions(t){const e=t.toLowerCase();return this.positions.filter(t=>t.protocol.toLowerCase().includes(e)||t.tokenSymbol.toLowerCase().includes(e)||t.network.toLowerCase().includes(e))}};async function l(){const t=o.getCurrentWallet();if(!t)return{success:!0,accounts:[]};return{success:!0,accounts:t.accounts.map(t=>t.address)}}async function d(t){const{address:e,network:r}=t;if(!e||!r)return{success:!1,error:"Missing address or network"};try{return{success:!0,balance:await o.getBalance(e,r)}}catch(t){return{success:!1,error:t instanceof Error?t.message:"Failed to get balance"}}}async function h(t){const{to:e,value:r,network:s}=t;if(!e||!r||!s)return{success:!1,error:"Missing transaction parameters"};try{return{success:!0,txHash:await c.sendTransaction(e,r,s)}}catch(t){return{success:!1,error:t instanceof Error?t.message:"Failed to send transaction"}}}async function w(){const t=o.getCurrentAccount();if(!t)return{success:!1,error:"No wallet available"};try{const{ethers:e}=await r.e(96).then(r.bind(r,57908)),{decryptData:s}=await Promise.resolve().then(r.bind(r,48302)),n=await async function(){try{return prompt("Enter your wallet password to sign this transaction:")}catch(t){return null}}();if(!n)return{success:!1,error:"Password required for signing"};const a=await s(t.privateKey,n);if(!a)return{success:!1,error:"Invalid password"};const o=new e.Wallet(a),i={to:"0x742d35Cc6634C0532925a3b8D4C9db96C4b4d8b6",value:e.parseEther("0.001"),data:"0x",gasLimit:"0x5208",gasPrice:e.parseUnits("20","gwei"),nonce:0};return{success:!0,signature:await o.signTransaction(i)}}catch(t){return{success:!1,error:t instanceof Error?t.message:"Signing failed"}}}window.addEventListener("message",async t=>{if(t.source===window&&"paycio-wallet-injected"===t.data.source)try{let e;if("WALLET_REQUEST"===t.data.type)e=await async function(t,e=[]){try{switch(t){case"eth_requestAccounts":case"eth_accounts":return await l();case"eth_getBalance":const[s,n]=e;return await d({address:s,network:"ethereum"});case"eth_sendTransaction":const[a]=e;return await h({to:a.to,value:a.value,network:"ethereum"});case"eth_signTransaction":return await w();case"eth_chainId":return{success:!0,data:"0x1"};case"net_version":return{success:!0,data:"1"};case"eth_getTransactionCount":return await async function(t){try{const{getTransactionCount:e}=await Promise.resolve().then(r.bind(r,18336));return{success:!0,data:await e(t,"ethereum")}}catch(t){return{success:!1,error:t instanceof Error?t.message:"Failed to get nonce"}}}(e[0]);case"eth_estimateGas":return await async function(t){try{const{estimateGas:e}=await Promise.resolve().then(r.bind(r,18336));return{success:!0,data:await e(t.from,t.to,t.value||"0x0",t.data||"0x","ethereum")}}catch(t){return{success:!1,error:t instanceof Error?t.message:"Failed to estimate gas"}}}(e[0]);case"eth_gasPrice":return await async function(){try{const{getGasPrice:t}=await Promise.resolve().then(r.bind(r,18336));return{success:!0,data:await t("ethereum")}}catch(t){return{success:!1,error:t instanceof Error?t.message:"Failed to get gas price"}}}();default:return{success:!1,error:`Method ${t} not supported`}}}catch(t){return{success:!1,error:t instanceof Error?t.message:"Unknown error"}}}(t.data.method,t.data.params);else switch(t.data.type){case"WALLET_CONNECT":e=await async function(){const t=o.getCurrentWallet();if(!t)return{success:!1,error:"No wallet available"};return{success:!0,address:t.address,network:t.currentNetwork}}();break;case"WALLET_GET_ACCOUNTS":e=await l();break;case"WALLET_GET_BALANCE":e=await d(t.data.params);break;case"WALLET_SIGN_TRANSACTION":e=await w();break;case"WALLET_SEND_TRANSACTION":e=await h(t.data.params);break;case"WALLET_SWITCH_NETWORK":e=await async function(t){const{networkId:e}=t;if(!e)return{success:!1,error:"Missing network ID"};try{return await o.switchNetwork(e),{success:!0}}catch(t){return{success:!1,error:t instanceof Error?t.message:"Failed to switch network"}}}(t.data.params);break;case"WALLET_GET_NETWORKS":e=await async function(){try{return{success:!0,networks:i.getAllNetworks()}}catch(t){return{success:!1,error:t instanceof Error?t.message:"Failed to get networks"}}}();break;case"WALLET_GET_NFTS":e=await async function(t){const{address:e,network:s}=t;if(!e||!s)return{success:!1,error:"Missing address or network"};try{const{NFTManager:t}=await r.e(463).then(r.bind(r,95463)),n=new t;return{success:!0,nfts:await n.importNFTs(e,s)}}catch(t){return{success:!1,error:t instanceof Error?t.message:"Failed to get NFTs"}}}(t.data.params);break;case"WALLET_GET_PORTFOLIO":e=await async function(){try{const{PortfolioManager:t}=await r.e(623).then(r.bind(r,85623)),e=new t;return{success:!0,portfolio:await e.getPortfolio()}}catch(t){return{success:!1,error:t instanceof Error?t.message:"Failed to get portfolio"}}}();break;case"WALLET_GET_DEFI_POSITIONS":e=await async function(){try{return{success:!0,positions:u.getAllPositions()}}catch(t){return{success:!1,error:t instanceof Error?t.message:"Failed to get DeFi positions"}}}();break;default:e={success:!1,error:"Unknown message type"}}window.postMessage({source:"paycio-wallet-content",id:t.data.id,result:e.success?e.data||e:void 0,error:e.success?void 0:e.error},"*")}catch(e){window.postMessage({source:"paycio-wallet-content",id:t.data.id,result:void 0,error:e instanceof Error?e.message:"Unknown error"},"*")}});const g=document.createElement("script");g.src=chrome.runtime.getURL("injected.js"),g.onload=()=>{g.remove()},(document.head||document.documentElement).appendChild(g)}},n={};function a(t){var e=n[t];if(void 0!==e)return e.exports;var r=n[t]={id:t,loaded:!1,exports:{}};return s[t].call(r.exports,r,r.exports,a),r.loaded=!0,r.exports}a.m=s,t=[],a.O=function(e,r,s,n){if(!r){var o=1/0;for(l=0;l<t.length;l++){r=t[l][0],s=t[l][1],n=t[l][2];for(var i=!0,c=0;c<r.length;c++)(!1&n||o>=n)&&Object.keys(a.O).every(function(t){return a.O[t](r[c])})?r.splice(c--,1):(i=!1,n<o&&(o=n));if(i){t.splice(l--,1);var u=s();void 0!==u&&(e=u)}}return e}n=n||0;for(var l=t.length;l>0&&t[l-1][2]>n;l--)t[l]=t[l-1];t[l]=[r,s,n]},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,{a:e}),e},a.d=function(t,e){for(var r in e)a.o(e,r)&&!a.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},a.f={},a.e=function(t){return Promise.all(Object.keys(a.f).reduce(function(e,r){return a.f[r](t,e),e},[]))},a.u=function(t){return t+".js"},a.miniCssF=function(t){},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e={},r="paycio-wallet:",a.l=function(t,s,n,o){if(e[t])e[t].push(s);else{var i,c;if(void 0!==n)for(var u=document.getElementsByTagName("script"),l=0;l<u.length;l++){var d=u[l];if(d.getAttribute("src")==t||d.getAttribute("data-webpack")==r+n){i=d;break}}i||(c=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,a.nc&&i.setAttribute("nonce",a.nc),i.setAttribute("data-webpack",r+n),i.src=t),e[t]=[s];var h=function(r,s){i.onerror=i.onload=null,clearTimeout(w);var n=e[t];if(delete e[t],i.parentNode&&i.parentNode.removeChild(i),n&&n.forEach(function(t){return t(s)}),r)return r(s)},w=setTimeout(h.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=h.bind(null,i.onerror),i.onload=h.bind(null,i.onload),c&&document.head.appendChild(i)}},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t},a.j=854,a.p="",function(){var t={854:0};a.f.j=function(e,r){var s=a.o(t,e)?t[e]:void 0;if(0!==s)if(s)r.push(s[2]);else{var n=new Promise(function(r,n){s=t[e]=[r,n]});r.push(s[2]=n);var o=a.p+a.u(e),i=new Error;a.l(o,function(r){if(a.o(t,e)&&(0!==(s=t[e])&&(t[e]=void 0),s)){var n=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;i.message="Loading chunk "+e+" failed.\n("+n+": "+o+")",i.name="ChunkLoadError",i.type=n,i.request=o,s[1](i)}},"chunk-"+e,e)}},a.O.j=function(e){return 0===t[e]};var e=function(e,r){var s,n,o=r[0],i=r[1],c=r[2],u=0;if(o.some(function(e){return 0!==t[e]})){for(s in i)a.o(i,s)&&(a.m[s]=i[s]);if(c)var l=c(a)}for(e&&e(r);u<o.length;u++)n=o[u],a.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return a.O(l)},r=self.webpackChunkpaycio_wallet=self.webpackChunkpaycio_wallet||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))}();var o=a.O(void 0,[96,671,336],function(){return a(81078)});o=a.O(o)}();