<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PayCio Wallet - Transaction Test Suite</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        h1 {
            text-align: center;
            color: #180CB2;
            margin-bottom: 30px;
            font-size: 2.5em;
        }
        
        .test-section {
            margin: 30px 0;
            padding: 20px;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            background: #f9f9f9;
        }
        
        .test-section h2 {
            color: #180CB2;
            margin-top: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .test-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #ddd;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .test-card h3 {
            margin-top: 0;
            color: #333;
        }
        
        button {
            background: #180CB2;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 5px;
        }
        
        button:hover {
            background: #0f0880;
            transform: translateY(-2px);
        }
        
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .result {
            margin-top: 15px;
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 12px;
            white-space: pre-wrap;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        
        .error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        
        .info {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
        }
        
        .log-container {
            background: #1e1e1e;
            color: #00ff00;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 20px;
        }
        
        .input-group {
            margin: 10px 0;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #333;
        }
        
        .input-group input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }
        
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .status-connected { background: #28a745; }
        .status-disconnected { background: #dc3545; }
        .status-pending { background: #ffc107; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸš€ PayCio Wallet Transaction Test Suite</h1>
        
        <!-- Wallet Status -->
        <div class="test-section">
            <h2>ðŸ“Š Wallet Status</h2>
            <div id="walletStatus">
                <p><span class="status-indicator status-disconnected"></span>Checking wallet connection...</p>
            </div>
        </div>
        
        <!-- EVM Transaction Tests -->
        <div class="test-section">
            <h2>â›½ EVM Transaction Tests</h2>
            <div class="test-grid">
                <div class="test-card">
                    <h3>Ethereum Transaction</h3>
                    <div class="input-group">
                        <label>To Address:</label>
                        <input type="text" id="ethTo" placeholder="0x..." value="0x742d35Cc6634C0532925a3b8D4C9db96C4b4d8b6">
                    </div>
                    <div class="input-group">
                        <label>Amount (ETH):</label>
                        <input type="text" id="ethAmount" placeholder="0.001" value="0.001">
                    </div>
                    <button onclick="testEthereumTransaction()">Send ETH Transaction</button>
                    <div id="ethResult" class="result" style="display: none;"></div>
                </div>
                
                <div class="test-card">
                    <h3>BSC Transaction</h3>
                    <div class="input-group">
                        <label>To Address:</label>
                        <input type="text" id="bscTo" placeholder="0x..." value="0x742d35Cc6634C0532925a3b8D4C9db96C4b4d8b6">
                    </div>
                    <div class="input-group">
                        <label>Amount (BNB):</label>
                        <input type="text" id="bscAmount" placeholder="0.001" value="0.001">
                    </div>
                    <button onclick="testBSCTransaction()">Send BNB Transaction</button>
                    <div id="bscResult" class="result" style="display: none;"></div>
                </div>
                
                <div class="test-card">
                    <h3>Polygon Transaction</h3>
                    <div class="input-group">
                        <label>To Address:</label>
                        <input type="text" id="polygonTo" placeholder="0x..." value="0x742d35Cc6634C0532925a3b8D4C9db96C4b4d8b6">
                    </div>
                    <div class="input-group">
                        <label>Amount (MATIC):</label>
                        <input type="text" id="polygonAmount" placeholder="0.001" value="0.001">
                    </div>
                    <button onclick="testPolygonTransaction()">Send MATIC Transaction</button>
                    <div id="polygonResult" class="result" style="display: none;"></div>
                </div>
            </div>
        </div>
        
        <!-- Non-EVM Transaction Tests -->
        <div class="test-section">
            <h2>ðŸª™ Non-EVM Transaction Tests</h2>
            <div class="test-grid">
                <div class="test-card">
                    <h3>Bitcoin Transaction</h3>
                    <div class="input-group">
                        <label>To Address:</label>
                        <input type="text" id="btcTo" placeholder="bc1..." value="bc1qxy2kgdygjrsqtzq2n0yrf2493p83kkfjhx0wlh">
                    </div>
                    <div class="input-group">
                        <label>Amount (BTC):</label>
                        <input type="text" id="btcAmount" placeholder="0.001" value="0.001">
                    </div>
                    <button onclick="testBitcoinTransaction()">Send BTC Transaction</button>
                    <div id="btcResult" class="result" style="display: none;"></div>
                </div>
                
                <div class="test-card">
                    <h3>Litecoin Transaction</h3>
                    <div class="input-group">
                        <label>To Address:</label>
                        <input type="text" id="ltcTo" placeholder="ltc1..." value="ltc1qxy2kgdygjrsqtzq2n0yrf2493p83kkfjhx0wlh">
                    </div>
                    <div class="input-group">
                        <label>Amount (LTC):</label>
                        <input type="text" id="ltcAmount" placeholder="0.001" value="0.001">
                    </div>
                    <button onclick="testLitecoinTransaction()">Send LTC Transaction</button>
                    <div id="ltcResult" class="result" style="display: none;"></div>
                </div>
                
                <div class="test-card">
                    <h3>Solana Transaction</h3>
                    <div class="input-group">
                        <label>To Address:</label>
                        <input type="text" id="solTo" placeholder="Base58..." value="9WzDXwBbmkg8ZTbNMqUxvQRAyrZzDsGYdLVL9zYtAWWM">
                    </div>
                    <div class="input-group">
                        <label>Amount (SOL):</label>
                        <input type="text" id="solAmount" placeholder="0.001" value="0.001">
                    </div>
                    <button onclick="testSolanaTransaction()">Send SOL Transaction</button>
                    <div id="solResult" class="result" style="display: none;"></div>
                </div>
                
                <div class="test-card">
                    <h3>TRON Transaction</h3>
                    <div class="input-group">
                        <label>To Address:</label>
                        <input type="text" id="tronTo" placeholder="T..." value="TLyqzVGLV1srkB7dToTAEqgDSfPtXRJZYH">
                    </div>
                    <div class="input-group">
                        <label>Amount (TRX):</label>
                        <input type="text" id="tronAmount" placeholder="1" value="1">
                    </div>
                    <button onclick="testTronTransaction()">Send TRX Transaction</button>
                    <div id="tronResult" class="result" style="display: none;"></div>
                </div>
                
                <div class="test-card">
                    <h3>TON Transaction</h3>
                    <div class="input-group">
                        <label>To Address:</label>
                        <input type="text" id="tonTo" placeholder="UQ..." value="UQAb3W9Z5Fm8VFvB7tR4Kp2sL6nM9xY1zA8bC5dE7fG">
                    </div>
                    <div class="input-group">
                        <label>Amount (TON):</label>
                        <input type="text" id="tonAmount" placeholder="0.1" value="0.1">
                    </div>
                    <button onclick="testTonTransaction()">Send TON Transaction</button>
                    <div id="tonResult" class="result" style="display: none;"></div>
                </div>
            </div>
        </div>
        
        <!-- Transaction History -->
        <div class="test-section">
            <h2>ðŸ“œ Transaction History</h2>
            <button onclick="loadTransactionHistory()">Load Transaction History</button>
            <div id="transactionHistory" class="result" style="display: none;"></div>
        </div>
        
        <!-- Comprehensive Logs -->
        <div class="test-section">
            <h2>ðŸ“‹ Comprehensive Logs</h2>
            <button onclick="clearLogs()">Clear Logs</button>
            <div id="logs" class="log-container"></div>
        </div>
    </div>

    <script>
        let logs = [];
        
        function log(message, type = 'info') {
            const timestamp = new Date().toISOString();
            const logEntry = `[${timestamp}] ${type.toUpperCase()}: ${message}`;
            logs.push(logEntry);
            
            const logsContainer = document.getElementById('logs');
            logsContainer.innerHTML = logs.join('\n');
            logsContainer.scrollTop = logsContainer.scrollHeight;
            
            console.log(logEntry);
        }
        
        function clearLogs() {
            logs = [];
            document.getElementById('logs').innerHTML = '';
        }
        
        function showResult(elementId, message, type = 'info') {
            const element = document.getElementById(elementId);
            element.style.display = 'block';
            element.className = `result ${type}`;
            element.textContent = message;
        }
        
        // Check wallet status
        async function checkWalletStatus() {
            try {
                log('Checking wallet status...');
                
                if (typeof window.ethereum !== 'undefined') {
                    const accounts = await window.ethereum.request({ method: 'eth_accounts' });
                    const chainId = await window.ethereum.request({ method: 'eth_chainId' });
                    
                    if (accounts.length > 0) {
                        document.getElementById('walletStatus').innerHTML = `
                            <p><span class="status-indicator status-connected"></span>Wallet Connected</p>
                            <p>Address: ${accounts[0]}</p>
                            <p>Chain ID: ${chainId}</p>
                        `;
                        log(`Wallet connected: ${accounts[0]} on chain ${chainId}`, 'success');
                    } else {
                        document.getElementById('walletStatus').innerHTML = `
                            <p><span class="status-indicator status-disconnected"></span>Wallet Not Connected</p>
                        `;
                        log('Wallet not connected', 'error');
                    }
                } else {
                    document.getElementById('walletStatus').innerHTML = `
                        <p><span class="status-indicator status-disconnected"></span>No Wallet Provider Found</p>
                    `;
                    log('No wallet provider found', 'error');
                }
            } catch (error) {
                log(`Wallet status check failed: ${error.message}`, 'error');
                document.getElementById('walletStatus').innerHTML = `
                    <p><span class="status-indicator status-disconnected"></span>Error: ${error.message}</p>
                `;
            }
        }
        
        // EVM Transaction Tests
        async function testEthereumTransaction() {
            try {
                log('Testing Ethereum transaction...');
                
                const to = document.getElementById('ethTo').value;
                const amount = document.getElementById('ethAmount').value;
                
                if (!to || !amount) {
                    throw new Error('Please fill in all fields');
                }
                
                const transaction = {
                    to: to,
                    value: `0x${(parseFloat(amount) * 1e18).toString(16)}`,
                    gasLimit: '0x5208',
                    gasPrice: '0x4a817c800'
                };
                
                const txHash = await window.ethereum.request({
                    method: 'eth_sendTransaction',
                    params: [transaction]
                });
                
                showResult('ethResult', `Transaction sent successfully!\nHash: ${txHash}`, 'success');
                log(`Ethereum transaction sent: ${txHash}`, 'success');
                
            } catch (error) {
                showResult('ethResult', `Transaction failed: ${error.message}`, 'error');
                log(`Ethereum transaction failed: ${error.message}`, 'error');
            }
        }
        
        async function testBSCTransaction() {
            try {
                log('Testing BSC transaction...');
                
                const to = document.getElementById('bscTo').value;
                const amount = document.getElementById('bscAmount').value;
                
                if (!to || !amount) {
                    throw new Error('Please fill in all fields');
                }
                
                // Switch to BSC first
                await window.ethereum.request({
                    method: 'wallet_switchEthereumChain',
                    params: [{ chainId: '0x38' }]
                });
                
                const transaction = {
                    to: to,
                    value: `0x${(parseFloat(amount) * 1e18).toString(16)}`,
                    gasLimit: '0x5208',
                    gasPrice: '0x3b9aca00'
                };
                
                const txHash = await window.ethereum.request({
                    method: 'eth_sendTransaction',
                    params: [transaction]
                });
                
                showResult('bscResult', `Transaction sent successfully!\nHash: ${txHash}`, 'success');
                log(`BSC transaction sent: ${txHash}`, 'success');
                
            } catch (error) {
                showResult('bscResult', `Transaction failed: ${error.message}`, 'error');
                log(`BSC transaction failed: ${error.message}`, 'error');
            }
        }
        
        async function testPolygonTransaction() {
            try {
                log('Testing Polygon transaction...');
                
                const to = document.getElementById('polygonTo').value;
                const amount = document.getElementById('polygonAmount').value;
                
                if (!to || !amount) {
                    throw new Error('Please fill in all fields');
                }
                
                // Switch to Polygon first
                await window.ethereum.request({
                    method: 'wallet_switchEthereumChain',
                    params: [{ chainId: '0x89' }]
                });
                
                const transaction = {
                    to: to,
                    value: `0x${(parseFloat(amount) * 1e18).toString(16)}`,
                    gasLimit: '0x5208',
                    gasPrice: '0x1dcd6500'
                };
                
                const txHash = await window.ethereum.request({
                    method: 'eth_sendTransaction',
                    params: [transaction]
                });
                
                showResult('polygonResult', `Transaction sent successfully!\nHash: ${txHash}`, 'success');
                log(`Polygon transaction sent: ${txHash}`, 'success');
                
            } catch (error) {
                showResult('polygonResult', `Transaction failed: ${error.message}`, 'error');
                log(`Polygon transaction failed: ${error.message}`, 'error');
            }
        }
        
        // Non-EVM Transaction Tests
        async function testBitcoinTransaction() {
            try {
                log('Testing Bitcoin transaction...');
                
                const to = document.getElementById('btcTo').value;
                const amount = document.getElementById('btcAmount').value;
                
                if (!to || !amount) {
                    throw new Error('Please fill in all fields');
                }
                
                const transaction = {
                    to: to,
                    amount: amount
                };
                
                // Test via background script
                const response = await chrome.runtime.sendMessage({
                    type: 'WALLET_REQUEST',
                    method: 'btc_sendTransaction',
                    params: [transaction]
                });
                
                if (response.success) {
                    showResult('btcResult', `Transaction sent successfully!\nHash: ${response.txid}`, 'success');
                    log(`Bitcoin transaction sent: ${response.txid}`, 'success');
                } else {
                    throw new Error(response.error || 'Transaction failed');
                }
                
            } catch (error) {
                showResult('btcResult', `Transaction failed: ${error.message}`, 'error');
                log(`Bitcoin transaction failed: ${error.message}`, 'error');
            }
        }
        
        async function testLitecoinTransaction() {
            try {
                log('Testing Litecoin transaction...');
                
                const to = document.getElementById('ltcTo').value;
                const amount = document.getElementById('ltcAmount').value;
                
                if (!to || !amount) {
                    throw new Error('Please fill in all fields');
                }
                
                const transaction = {
                    to: to,
                    amount: amount
                };
                
                const response = await chrome.runtime.sendMessage({
                    type: 'WALLET_REQUEST',
                    method: 'ltc_sendTransaction',
                    params: [transaction]
                });
                
                if (response.success) {
                    showResult('ltcResult', `Transaction sent successfully!\nHash: ${response.txid}`, 'success');
                    log(`Litecoin transaction sent: ${response.txid}`, 'success');
                } else {
                    throw new Error(response.error || 'Transaction failed');
                }
                
            } catch (error) {
                showResult('ltcResult', `Transaction failed: ${error.message}`, 'error');
                log(`Litecoin transaction failed: ${error.message}`, 'error');
            }
        }
        
        async function testSolanaTransaction() {
            try {
                log('Testing Solana transaction...');
                
                const to = document.getElementById('solTo').value;
                const amount = document.getElementById('solAmount').value;
                
                if (!to || !amount) {
                    throw new Error('Please fill in all fields');
                }
                
                const transaction = {
                    to: to,
                    amount: amount
                };
                
                const response = await chrome.runtime.sendMessage({
                    type: 'WALLET_REQUEST',
                    method: 'sol_sendTransaction',
                    params: [transaction]
                });
                
                if (response.success) {
                    showResult('solResult', `Transaction sent successfully!\nSignature: ${response.signature}`, 'success');
                    log(`Solana transaction sent: ${response.signature}`, 'success');
                } else {
                    throw new Error(response.error || 'Transaction failed');
                }
                
            } catch (error) {
                showResult('solResult', `Transaction failed: ${error.message}`, 'error');
                log(`Solana transaction failed: ${error.message}`, 'error');
            }
        }
        
        async function testTronTransaction() {
            try {
                log('Testing TRON transaction...');
                
                const to = document.getElementById('tronTo').value;
                const amount = document.getElementById('tronAmount').value;
                
                if (!to || !amount) {
                    throw new Error('Please fill in all fields');
                }
                
                const transaction = {
                    to: to,
                    amount: amount
                };
                
                const response = await chrome.runtime.sendMessage({
                    type: 'WALLET_REQUEST',
                    method: 'tron_sendTransaction',
                    params: [transaction]
                });
                
                if (response.success) {
                    showResult('tronResult', `Transaction sent successfully!\nHash: ${response.txid}`, 'success');
                    log(`TRON transaction sent: ${response.txid}`, 'success');
                } else {
                    throw new Error(response.error || 'Transaction failed');
                }
                
            } catch (error) {
                showResult('tronResult', `Transaction failed: ${error.message}`, 'error');
                log(`TRON transaction failed: ${error.message}`, 'error');
            }
        }
        
        async function testTonTransaction() {
            try {
                log('Testing TON transaction...');
                
                const to = document.getElementById('tonTo').value;
                const amount = document.getElementById('tonAmount').value;
                
                if (!to || !amount) {
                    throw new Error('Please fill in all fields');
                }
                
                const transaction = {
                    to: to,
                    amount: amount
                };
                
                const response = await chrome.runtime.sendMessage({
                    type: 'WALLET_REQUEST',
                    method: 'ton_sendTransaction',
                    params: [transaction]
                });
                
                if (response.success) {
                    showResult('tonResult', `Transaction sent successfully!\nHash: ${response.hash}`, 'success');
                    log(`TON transaction sent: ${response.hash}`, 'success');
                } else {
                    throw new Error(response.error || 'Transaction failed');
                }
                
            } catch (error) {
                showResult('tonResult', `Transaction failed: ${error.message}`, 'error');
                log(`TON transaction failed: ${error.message}`, 'error');
            }
        }
        
        // Load transaction history
        async function loadTransactionHistory() {
            try {
                log('Loading transaction history...');
                
                const response = await chrome.runtime.sendMessage({
                    type: 'GET_TRANSACTION_HISTORY'
                });
                
                if (response.success && response.transactions) {
                    const history = response.transactions.map(tx => 
                        `${tx.network.toUpperCase()}: ${tx.hash}\n` +
                        `From: ${tx.from}\n` +
                        `To: ${tx.to}\n` +
                        `Value: ${tx.value}\n` +
                        `Status: ${tx.status}\n` +
                        `Time: ${new Date(tx.timestamp).toLocaleString()}\n` +
                        `---`
                    ).join('\n\n');
                    
                    showResult('transactionHistory', history, 'info');
                    log(`Loaded ${response.transactions.length} transactions`, 'success');
                } else {
                    showResult('transactionHistory', 'No transactions found', 'info');
                    log('No transactions found', 'info');
                }
                
            } catch (error) {
                showResult('transactionHistory', `Failed to load history: ${error.message}`, 'error');
                log(`Failed to load transaction history: ${error.message}`, 'error');
            }
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            log('Transaction test suite initialized', 'success');
            checkWalletStatus();
        });
    </script>
</body>
</html>
