<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PayCio Wallet Connection Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            background: #fafafa;
        }
        .test-section h3 {
            margin-top: 0;
            color: #555;
        }
        button {
            background: #6366f1;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
            transition: background 0.2s;
        }
        button:hover {
            background: #5855eb;
        }
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            white-space: pre-wrap;
            max-height: 200px;
            overflow-y: auto;
        }
        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        .error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        .info {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
        }
        .status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 10px;
        }
        .status.connected {
            background: #d4edda;
            color: #155724;
        }
        .status.disconnected {
            background: #f8d7da;
            color: #721c24;
        }
        .auto-test {
            background: #28a745;
            color: white;
            padding: 15px 30px;
            font-size: 16px;
            margin: 20px 0;
        }
        .clear-logs {
            background: #6c757d;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç PayCio Wallet Connection Test</h1>
        
        <div class="test-section">
            <h3>Provider Detection <span id="provider-status" class="status disconnected">Not Detected</span></h3>
            <button onclick="testProviderDetection()">Test Provider Detection</button>
            <button onclick="testEIP6963()">Test EIP-6963 Detection</button>
            <div id="provider-result" class="result info" style="display: none;"></div>
        </div>

        <div class="test-section">
            <h3>Basic Connection</h3>
            <button onclick="testConnection()">Test Connection</button>
            <button onclick="testAccounts()">Test Accounts</button>
            <button onclick="testChainId()">Test Chain ID</button>
            <div id="connection-result" class="result info" style="display: none;"></div>
        </div>

        <div class="test-section">
            <h3>Network Information</h3>
            <button onclick="testNetworkInfo()">Test Network Info</button>
            <button onclick="testBlockNumber()">Test Block Number</button>
            <button onclick="testGasPrice()">Test Gas Price</button>
            <div id="network-result" class="result info" style="display: none;"></div>
        </div>

        <div class="test-section">
            <h3>Account & Balance</h3>
            <button onclick="testBalance()">Test Balance</button>
            <button onclick="testTransactionCount()">Test Transaction Count</button>
            <button onclick="testEstimateGas()">Test Gas Estimation</button>
            <div id="account-result" class="result info" style="display: none;"></div>
        </div>

        <div class="test-section">
            <h3>Permissions (EIP-2255)</h3>
            <button onclick="testRequestPermissions()">Test Request Permissions</button>
            <button onclick="testGetPermissions()">Test Get Permissions</button>
            <button onclick="testRevokePermissions()">Test Revoke Permissions</button>
            <div id="permissions-result" class="result info" style="display: none;"></div>
        </div>

        <div class="test-section">
            <h3>Message Signing</h3>
            <button onclick="testPersonalSign()">Test Personal Sign</button>
            <button onclick="testSignTypedData()">Test Sign Typed Data</button>
            <button onclick="testSignData()">Test Sign Data</button>
            <div id="signing-result" class="result info" style="display: none;"></div>
        </div>

        <div class="test-section">
            <h3>Transaction Signing</h3>
            <button onclick="testSignTransaction()">Test Sign Transaction</button>
            <button onclick="testSendTransaction()">Test Send Transaction</button>
            <div id="transaction-result" class="result info" style="display: none;"></div>
        </div>

        <div class="test-section">
            <h3>Network Management</h3>
            <button onclick="testSwitchChain()">Test Switch Chain</button>
            <button onclick="testAddChain()">Test Add Chain</button>
            <div id="network-mgmt-result" class="result info" style="display: none;"></div>
        </div>

        <div class="test-section">
            <h3>Block Data</h3>
            <button onclick="testGetBlock()">Test Get Block</button>
            <button onclick="testGetBlockByNumber()">Test Get Block By Number</button>
            <div id="block-result" class="result info" style="display: none;"></div>
        </div>

        <div style="text-align: center; margin: 30px 0;">
            <button class="auto-test" onclick="runAllTests()">üöÄ Run All Tests</button>
            <button class="clear-logs" onclick="clearAllLogs()">üóëÔ∏è Clear All Logs</button>
        </div>

        <div class="test-section">
            <h3>Console Logs</h3>
            <div id="console-logs" class="result info" style="height: 300px; overflow-y: auto;"></div>
        </div>
    </div>

    <script>
        // Override console.log to capture logs
        const originalLog = console.log;
        const originalError = console.error;
        const originalWarn = console.warn;
        
        function addToConsoleLogs(message, type = 'log') {
            const logsDiv = document.getElementById('console-logs');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.style.marginBottom = '5px';
            logEntry.style.padding = '5px';
            logEntry.style.borderRadius = '3px';
            
            if (type === 'error') {
                logEntry.style.background = '#f8d7da';
                logEntry.style.color = '#721c24';
            } else if (type === 'warn') {
                logEntry.style.background = '#fff3cd';
                logEntry.style.color = '#856404';
            } else {
                logEntry.style.background = '#d1ecf1';
                logEntry.style.color = '#0c5460';
            }
            
            logEntry.textContent = `[${timestamp}] ${message}`;
            logsDiv.appendChild(logEntry);
            logsDiv.scrollTop = logsDiv.scrollHeight;
        }
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            addToConsoleLogs(args.join(' '), 'log');
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            addToConsoleLogs(args.join(' '), 'error');
        };
        
        console.warn = function(...args) {
            originalWarn.apply(console, args);
            addToConsoleLogs(args.join(' '), 'warn');
        };

        // Test functions
        function showResult(elementId, message, isSuccess = true) {
            const element = document.getElementById(elementId);
            element.style.display = 'block';
            element.className = `result ${isSuccess ? 'success' : 'error'}`;
            element.textContent = message;
        }

        function testProviderDetection() {
            console.log('üîç Testing provider detection...');
            
            let result = 'Provider Detection Results:\n\n';
            
            // Test window.ethereum
            if (window.ethereum) {
                result += '‚úÖ window.ethereum found\n';
                result += `   - isPayCio: ${window.ethereum.isPayCio || 'undefined'}\n`;
                result += `   - isMetaMask: ${window.ethereum.isMetaMask || 'undefined'}\n`;
                result += `   - chainId: ${window.ethereum.chainId || 'undefined'}\n`;
                result += `   - networkVersion: ${window.ethereum.networkVersion || 'undefined'}\n`;
                result += `   - selectedAddress: ${window.ethereum.selectedAddress || 'undefined'}\n`;
                
                document.getElementById('provider-status').textContent = 'Connected';
                document.getElementById('provider-status').className = 'status connected';
            } else {
                result += '‚ùå window.ethereum not found\n';
                document.getElementById('provider-status').textContent = 'Not Detected';
                document.getElementById('provider-status').className = 'status disconnected';
            }
            
            // Test PayCio specific
            if (window.paycioWallet) {
                result += '‚úÖ window.paycioWallet found\n';
            } else {
                result += '‚ùå window.paycioWallet not found\n';
            }
            
            showResult('provider-result', result, window.ethereum);
        }

        function testEIP6963() {
            console.log('üîç Testing EIP-6963 detection...');
            
            let result = 'EIP-6963 Detection Results:\n\n';
            const providers = [];
            
            // Listen for provider announcements
            const announcementHandler = (event) => {
                providers.push(event.detail);
                console.log('EIP-6963 provider announced:', event.detail.info.name, event.detail.info.rdns);
            };
            
            window.addEventListener('eip6963:announceProvider', announcementHandler);
            
            // Request providers
            window.dispatchEvent(new CustomEvent('eip6963:requestProvider'));
            
            // Wait for announcements
            setTimeout(() => {
                window.removeEventListener('eip6963:announceProvider', announcementHandler);
                
                if (providers.length > 0) {
                    result += `‚úÖ Found ${providers.length} EIP-6963 provider(s)\n\n`;
                    
                    // Check if PayCio is among the providers
                    const paycioProvider = providers.find(p => p.info.rdns === 'com.paycio.wallet');
                    if (paycioProvider) {
                        result += '‚úÖ PayCio provider detected via EIP-6963\n';
                    } else {
                        result += '‚ö†Ô∏è PayCio not found in EIP-6963 providers\n';
                    }
                    
                    providers.forEach((provider, index) => {
                        result += `\nProvider ${index + 1}:\n`;
                        result += `   - Name: ${provider.info.name}\n`;
                        result += `   - RDNS: ${provider.info.rdns}\n`;
                        result += `   - UUID: ${provider.info.uuid}\n`;
                    });
                } else {
                    result += '‚ùå No EIP-6963 providers detected\n\n';
                    result += 'This could mean:\n';
                    result += '  - No wallet extensions installed\n';
                    result += '  - EIP-6963 not implemented\n';
                    result += '  - Providers not announcing themselves\n';
                }
                
                showResult('provider-result', result, providers.length > 0);
            }, 2000);
        }

        async function testConnection() {
            console.log('üîç Testing connection...');
            
            try {
                if (!window.ethereum) {
                    throw new Error('No ethereum provider found');
                }
                
                const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                const result = `Connection Test Results:\n\n‚úÖ Successfully connected!\nAccounts: ${JSON.stringify(accounts, null, 2)}`;
                showResult('connection-result', result, true);
            } catch (error) {
                const result = `Connection Test Results:\n\n‚ùå Connection failed:\n${error.message}`;
                showResult('connection-result', result, false);
            }
        }

        async function testAccounts() {
            console.log('üîç Testing accounts...');
            
            try {
                const accounts = await window.ethereum.request({ method: 'eth_accounts' });
                const result = `Accounts Test Results:\n\n‚úÖ Accounts retrieved:\n${JSON.stringify(accounts, null, 2)}`;
                showResult('connection-result', result, true);
            } catch (error) {
                const result = `Accounts Test Results:\n\n‚ùå Failed to get accounts:\n${error.message}`;
                showResult('connection-result', result, false);
            }
        }

        async function testChainId() {
            console.log('üîç Testing chain ID...');
            
            try {
                const chainId = await window.ethereum.request({ method: 'eth_chainId' });
                const result = `Chain ID Test Results:\n\n‚úÖ Chain ID: ${chainId}\nDecimal: ${parseInt(chainId, 16)}`;
                showResult('connection-result', result, true);
            } catch (error) {
                const result = `Chain ID Test Results:\n\n‚ùå Failed to get chain ID:\n${error.message}`;
                showResult('connection-result', result, false);
            }
        }

        async function testNetworkInfo() {
            console.log('üîç Testing network info...');
            
            try {
                const [chainId, networkVersion] = await Promise.all([
                    window.ethereum.request({ method: 'eth_chainId' }),
                    window.ethereum.request({ method: 'net_version' })
                ]);
                
                const result = `Network Info Test Results:\n\n‚úÖ Network Information:\nChain ID: ${chainId}\nNetwork Version: ${networkVersion}`;
                showResult('network-result', result, true);
            } catch (error) {
                const result = `Network Info Test Results:\n\n‚ùå Failed to get network info:\n${error.message}`;
                showResult('network-result', result, false);
            }
        }

        async function testBlockNumber() {
            console.log('üîç Testing block number...');
            
            try {
                const blockNumber = await window.ethereum.request({ method: 'eth_blockNumber' });
                const result = `Block Number Test Results:\n\n‚úÖ Block Number: ${blockNumber}\nDecimal: ${parseInt(blockNumber, 16)}`;
                showResult('network-result', result, true);
            } catch (error) {
                const result = `Block Number Test Results:\n\n‚ùå Failed to get block number:\n${error.message}`;
                showResult('network-result', result, false);
            }
        }

        async function testGasPrice() {
            console.log('üîç Testing gas price...');
            
            try {
                const gasPrice = await window.ethereum.request({ method: 'eth_gasPrice' });
                const result = `Gas Price Test Results:\n\n‚úÖ Gas Price: ${gasPrice}\nDecimal: ${parseInt(gasPrice, 16)} wei`;
                showResult('network-result', result, true);
            } catch (error) {
                const result = `Gas Price Test Results:\n\n‚ùå Failed to get gas price:\n${error.message}`;
                showResult('network-result', result, false);
            }
        }

        async function testBalance() {
            console.log('üîç Testing balance...');
            
            try {
                const accounts = await window.ethereum.request({ method: 'eth_accounts' });
                if (accounts.length === 0) {
                    throw new Error('No accounts available');
                }
                
                const balance = await window.ethereum.request({ 
                    method: 'eth_getBalance', 
                    params: [accounts[0], 'latest'] 
                });
                
                const result = `Balance Test Results:\n\n‚úÖ Balance for ${accounts[0]}:\n${balance} wei\n${(parseInt(balance, 16) / 1e18).toFixed(6)} ETH`;
                showResult('account-result', result, true);
            } catch (error) {
                const result = `Balance Test Results:\n\n‚ùå Failed to get balance:\n${error.message}`;
                showResult('account-result', result, false);
            }
        }

        async function testTransactionCount() {
            console.log('üîç Testing transaction count...');
            
            try {
                const accounts = await window.ethereum.request({ method: 'eth_accounts' });
                if (accounts.length === 0) {
                    throw new Error('No accounts available');
                }
                
                const txCount = await window.ethereum.request({ 
                    method: 'eth_getTransactionCount', 
                    params: [accounts[0], 'latest'] 
                });
                
                const result = `Transaction Count Test Results:\n\n‚úÖ Transaction count for ${accounts[0]}:\n${txCount}\nDecimal: ${parseInt(txCount, 16)}`;
                showResult('account-result', result, true);
            } catch (error) {
                const result = `Transaction Count Test Results:\n\n‚ùå Failed to get transaction count:\n${error.message}`;
                showResult('account-result', result, false);
            }
        }

        async function testEstimateGas() {
            console.log('üîç Testing gas estimation...');
            
            try {
                const accounts = await window.ethereum.request({ method: 'eth_accounts' });
                if (accounts.length === 0) {
                    throw new Error('No accounts available');
                }
                
                const gasEstimate = await window.ethereum.request({ 
                    method: 'eth_estimateGas', 
                    params: [{
                        from: accounts[0],
                        to: accounts[0],
                        value: '0x0'
                    }] 
                });
                
                const result = `Gas Estimation Test Results:\n\n‚úÖ Gas estimate: ${gasEstimate}\nDecimal: ${parseInt(gasEstimate, 16)}`;
                showResult('account-result', result, true);
            } catch (error) {
                const result = `Gas Estimation Test Results:\n\n‚ùå Failed to estimate gas:\n${error.message}`;
                showResult('account-result', result, false);
            }
        }

        async function testRequestPermissions() {
            console.log('üîç Testing request permissions...');
            
            try {
                const permissions = await window.ethereum.request({ 
                    method: 'wallet_requestPermissions',
                    params: [{ eth_accounts: {} }]
                });
                
                const result = `Request Permissions Test Results:\n\n‚úÖ Permissions granted:\n${JSON.stringify(permissions, null, 2)}`;
                showResult('permissions-result', result, true);
            } catch (error) {
                const result = `Request Permissions Test Results:\n\n‚ùå Failed to request permissions:\n${error.message}`;
                showResult('permissions-result', result, false);
            }
        }

        async function testGetPermissions() {
            console.log('üîç Testing get permissions...');
            
            try {
                const permissions = await window.ethereum.request({ 
                    method: 'wallet_getPermissions'
                });
                
                const result = `Get Permissions Test Results:\n\n‚úÖ Current permissions:\n${JSON.stringify(permissions, null, 2)}`;
                showResult('permissions-result', result, true);
            } catch (error) {
                const result = `Get Permissions Test Results:\n\n‚ùå Failed to get permissions:\n${error.message}`;
                showResult('permissions-result', result, false);
            }
        }

        async function testRevokePermissions() {
            console.log('üîç Testing revoke permissions...');
            
            try {
                const result = await window.ethereum.request({ 
                    method: 'wallet_revokePermissions',
                    params: [{ eth_accounts: {} }]
                });
                
                const resultText = `Revoke Permissions Test Results:\n\n‚úÖ Permissions revoked:\n${JSON.stringify(result, null, 2)}`;
                showResult('permissions-result', resultText, true);
            } catch (error) {
                const result = `Revoke Permissions Test Results:\n\n‚ùå Failed to revoke permissions:\n${error.message}`;
                showResult('permissions-result', result, false);
            }
        }

        async function testPersonalSign() {
            console.log('üîç Testing personal sign...');
            
            try {
                const accounts = await window.ethereum.request({ method: 'eth_accounts' });
                if (accounts.length === 0) {
                    throw new Error('No accounts available');
                }
                
                const message = 'Hello PayCio Wallet!';
                const signature = await window.ethereum.request({ 
                    method: 'personal_sign',
                    params: [message, accounts[0]]
                });
                
                const result = `Personal Sign Test Results:\n\n‚úÖ Message signed successfully!\nMessage: ${message}\nSignature: ${signature}`;
                showResult('signing-result', result, true);
            } catch (error) {
                const result = `Personal Sign Test Results:\n\n‚ùå Failed to sign message:\n${error.message}`;
                showResult('signing-result', result, false);
            }
        }

        async function testSignTypedData() {
            console.log('üîç Testing sign typed data...');
            
            try {
                const accounts = await window.ethereum.request({ method: 'eth_accounts' });
                if (accounts.length === 0) {
                    throw new Error('No accounts available');
                }
                
                const typedData = {
                    domain: {
                        name: 'PayCio Test',
                        version: '1',
                        chainId: 1,
                        verifyingContract: '0x0000000000000000000000000000000000000000'
                    },
                    types: {
                        Person: [
                            { name: 'name', type: 'string' },
                            { name: 'wallet', type: 'address' }
                        ]
                    },
                    primaryType: 'Person',
                    message: {
                        name: 'PayCio User',
                        wallet: accounts[0]
                    }
                };
                
                const signature = await window.ethereum.request({ 
                    method: 'eth_signTypedData_v4',
                    params: [accounts[0], JSON.stringify(typedData)]
                });
                
                const result = `Sign Typed Data Test Results:\n\n‚úÖ Typed data signed successfully!\nSignature: ${signature}`;
                showResult('signing-result', result, true);
            } catch (error) {
                const result = `Sign Typed Data Test Results:\n\n‚ùå Failed to sign typed data:\n${error.message}`;
                showResult('signing-result', result, false);
            }
        }

        async function testSignData() {
            console.log('üîç Testing sign data...');
            
            try {
                const accounts = await window.ethereum.request({ method: 'eth_accounts' });
                if (accounts.length === 0) {
                    throw new Error('No accounts available');
                }
                
                const data = '0x48656c6c6f2050617943696f'; // "Hello PayCio" in hex
                const signature = await window.ethereum.request({ 
                    method: 'eth_sign',
                    params: [accounts[0], data]
                });
                
                const result = `Sign Data Test Results:\n\n‚úÖ Data signed successfully!\nData: ${data}\nSignature: ${signature}`;
                showResult('signing-result', result, true);
            } catch (error) {
                const result = `Sign Data Test Results:\n\n‚ùå Failed to sign data:\n${error.message}`;
                showResult('signing-result', result, false);
            }
        }

        async function testSignTransaction() {
            console.log('üîç Testing sign transaction...');
            
            try {
                const accounts = await window.ethereum.request({ method: 'eth_accounts' });
                if (accounts.length === 0) {
                    throw new Error('No accounts available');
                }
                
                const transaction = {
                    from: accounts[0],
                    to: accounts[0],
                    value: '0x0',
                    gas: '0x5208',
                    gasPrice: '0x3b9aca00',
                    nonce: '0x0'
                };
                
                const signedTx = await window.ethereum.request({ 
                    method: 'eth_signTransaction',
                    params: [transaction]
                });
                
                const result = `Sign Transaction Test Results:\n\n‚úÖ Transaction signed successfully!\nSigned Transaction: ${signedTx}`;
                showResult('transaction-result', result, true);
            } catch (error) {
                const result = `Sign Transaction Test Results:\n\n‚ùå Failed to sign transaction:\n${error.message}`;
                showResult('transaction-result', result, false);
            }
        }

        async function testSendTransaction() {
            console.log('üîç Testing send transaction...');
            
            try {
                const accounts = await window.ethereum.request({ method: 'eth_accounts' });
                if (accounts.length === 0) {
                    throw new Error('No accounts available');
                }
                
                const transaction = {
                    from: accounts[0],
                    to: accounts[0],
                    value: '0x0',
                    gas: '0x5208'
                };
                
                const txHash = await window.ethereum.request({ 
                    method: 'eth_sendTransaction',
                    params: [transaction]
                });
                
                const result = `Send Transaction Test Results:\n\n‚úÖ Transaction sent successfully!\nTransaction Hash: ${txHash}`;
                showResult('transaction-result', result, true);
            } catch (error) {
                const result = `Send Transaction Test Results:\n\n‚ùå Failed to send transaction:\n${error.message}`;
                showResult('transaction-result', result, false);
            }
        }

        async function testSwitchChain() {
            console.log('üîç Testing switch chain...');
            
            try {
                const result = await window.ethereum.request({ 
                    method: 'wallet_switchEthereumChain',
                    params: [{ chainId: '0x1' }] // Ethereum mainnet
                });
                
                const resultText = `Switch Chain Test Results:\n\n‚úÖ Chain switched successfully!\nResult: ${JSON.stringify(result, null, 2)}`;
                showResult('network-mgmt-result', resultText, true);
            } catch (error) {
                const result = `Switch Chain Test Results:\n\n‚ùå Failed to switch chain:\n${error.message}`;
                showResult('network-mgmt-result', result, false);
            }
        }

        async function testAddChain() {
            console.log('üîç Testing add chain...');
            
            try {
                const chainParams = {
                    chainId: '0x89', // Polygon
                    chainName: 'Polygon',
                    nativeCurrency: {
                        name: 'MATIC',
                        symbol: 'MATIC',
                        decimals: 18
                    },
                    rpcUrls: ['https://polygon-rpc.com'],
                    blockExplorerUrls: ['https://polygonscan.com']
                };
                
                const result = await window.ethereum.request({ 
                    method: 'wallet_addEthereumChain',
                    params: [chainParams]
                });
                
                const resultText = `Add Chain Test Results:\n\n‚úÖ Chain added successfully!\nResult: ${JSON.stringify(result, null, 2)}`;
                showResult('network-mgmt-result', resultText, true);
            } catch (error) {
                const result = `Add Chain Test Results:\n\n‚ùå Failed to add chain:\n${error.message}`;
                showResult('network-mgmt-result', result, false);
            }
        }

        async function testGetBlock() {
            console.log('üîç Testing get block...');
            
            try {
                const blockNumber = await window.ethereum.request({ method: 'eth_blockNumber' });
                const block = await window.ethereum.request({ 
                    method: 'eth_getBlockByNumber',
                    params: [blockNumber, false]
                });
                
                const result = `Get Block Test Results:\n\n‚úÖ Block retrieved successfully!\nBlock Number: ${block.number}\nBlock Hash: ${block.hash}\nTimestamp: ${block.timestamp}`;
                showResult('block-result', result, true);
            } catch (error) {
                const result = `Get Block Test Results:\n\n‚ùå Failed to get block:\n${error.message}`;
                showResult('block-result', result, false);
            }
        }

        async function testGetBlockByNumber() {
            console.log('üîç Testing get block by number...');
            
            try {
                const block = await window.ethereum.request({ 
                    method: 'eth_getBlockByNumber',
                    params: ['latest', false]
                });
                
                const result = `Get Block By Number Test Results:\n\n‚úÖ Block retrieved successfully!\nBlock Number: ${block.number}\nBlock Hash: ${block.hash}\nGas Limit: ${block.gasLimit}\nGas Used: ${block.gasUsed}`;
                showResult('block-result', result, true);
            } catch (error) {
                const result = `Get Block By Number Test Results:\n\n‚ùå Failed to get block by number:\n${error.message}`;
                showResult('block-result', result, false);
            }
        }

        async function runAllTests() {
            console.log('üöÄ Running all tests...');
            
            const tests = [
                { name: 'Provider Detection', fn: testProviderDetection },
                { name: 'EIP-6963 Detection', fn: testEIP6963 },
                { name: 'Connection', fn: testConnection },
                { name: 'Accounts', fn: testAccounts },
                { name: 'Chain ID', fn: testChainId },
                { name: 'Network Info', fn: testNetworkInfo },
                { name: 'Block Number', fn: testBlockNumber },
                { name: 'Gas Price', fn: testGasPrice },
                { name: 'Balance', fn: testBalance },
                { name: 'Transaction Count', fn: testTransactionCount },
                { name: 'Gas Estimation', fn: testEstimateGas },
                { name: 'Request Permissions', fn: testRequestPermissions },
                { name: 'Get Permissions', fn: testGetPermissions },
                { name: 'Revoke Permissions', fn: testRevokePermissions },
                { name: 'Personal Sign', fn: testPersonalSign },
                { name: 'Sign Typed Data', fn: testSignTypedData },
                { name: 'Sign Data', fn: testSignData },
                { name: 'Sign Transaction', fn: testSignTransaction },
                { name: 'Send Transaction', fn: testSendTransaction },
                { name: 'Switch Chain', fn: testSwitchChain },
                { name: 'Add Chain', fn: testAddChain },
                { name: 'Get Block', fn: testGetBlock },
                { name: 'Get Block By Number', fn: testGetBlockByNumber }
            ];
            
            for (const test of tests) {
                console.log(`\nüß™ Running: ${test.name}`);
                try {
                    await test.fn();
                    await new Promise(resolve => setTimeout(resolve, 1000)); // Wait 1 second between tests
                } catch (error) {
                    console.error(`‚ùå Test failed: ${test.name} - ${error.message}`);
                }
            }
            
            console.log('\n‚úÖ All tests completed!');
        }

        function clearAllLogs() {
            const resultElements = document.querySelectorAll('.result');
            resultElements.forEach(element => {
                element.style.display = 'none';
                element.textContent = '';
            });
            
            document.getElementById('console-logs').innerHTML = '';
            console.log('üóëÔ∏è All logs cleared');
        }

        // Auto-run provider detection on page load
        window.addEventListener('load', () => {
            console.log('üîç PayCio Wallet Test Page Loaded');
            setTimeout(testProviderDetection, 1000);
        });
    </script>
</body>
</html>
